{% extends "base.html" %}
{% load static %}


{% block content %}
<div class='container-fluid '>
  {% comment %} breadcrumbs  {% endcomment %}
  <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item text-dark" aria-current="page" style='text-decoration: underline;'>Edit Basket</li>
      <li class="breadcrumb-item text-secondary" aria-current="page" >Shipping Details</li>
      <li class="breadcrumb-item text-secondary" aria-current="page" >Review and Payment</li>
    </ol>
  </nav>
  <div class="container-fluid d-flex justify-content-center align-items-center">
    <a href="{% url 'products:products' %}" class="btn btn-outline-dark btn-2 m-3" style="min-width: 10rem;">Keep Shopping</a>
    <a href="{% url 'checkout:shipping_info' %}" class="btn btn-outline-dark btn-1 m-3" style="min-width: 10rem;">Next</a>
  </div>
  {% comment %} basket list  {% endcomment %}
  <div class="container border rounded">
    {% if not basket_results %}
      <p>Nothing here, keep shopping!</p>
    {% else %}
    {% for i in basket_results.basket_products.all %}
    {% comment %} product rows  {% endcomment %}
    <div class="row m-3 justify-content-md-center" style='background-color: #FFCFD2;'>
      {% comment %} images  {% endcomment %}
      <div class="col m-1 col-lg-2 border">
        <img class="" src="{{ i.product_image.url }}" alt="{{ product.name }}" />
      </div>
      {% comment %} product detail  {% endcomment %}
      <div class="col m-1 col-lg-4 text-start">
        <p class='fs-4'>{{ i.product.name }}</p>       
        <p class='fs-6'>${{ i.product.price }} (x{{ i.quantity }})</p>
        <p class='fs-6'>Total: $ {% widthratio i.quantity 1 i.product.price %}</p>
      </div>  
      {% comment %} qty edits  {% endcomment %}
      <div class="col g-3 m-1 col-lg-2 d-flex align-items-center">
        <div class="col p-3 d-flex align-items-center">
          <form action="{% url 'checkout:update_basket' i.id %}" method="POST">
            {% csrf_token %}
            <div class="row">
              <input type="number" name="quantity" value="{{ i.quantity }}" min="1" style="width: 80px; ">
            </div>
            <div class="row">
            <button class="btn btn-outline-dark" type="submit">Update</button>
            </div>
            <input type="hidden" name="redirect_url" value="{{ request.path }}" />
          </form>
        </div>
        {% comment %} qty edit buttons  {% endcomment %}
        <div class="col">
          <form action="{% url 'checkout:remove_from_basket' i.id %}" method="POST">
            {% csrf_token %}
            <input type="hidden" name="redirect_url" value="{{ request.path }}" />
            <button class="btn btn-outline-dark" type="submit" style="width: 80px; ">Remove</button>
          </form>     
        </div>
      </div>
    </div>
    {% endfor %}
    {% endif %}
  </div>
  {% comment %} end basket list  {% endcomment %}
  <div class="container-fluid d-flex justify-content-center align-items-center">
    <a href="{% url 'products:products' %}" class="btn btn-outline-dark btn-2 m-3" style="min-width: 10rem;">Keep Shopping</a>
    <a href="{% url 'checkout:shipping_info' %}" class="btn btn-outline-dark btn-1 m-3" style="min-width: 10rem;">Next</a>
  </div>
</div>
{% endblock %}